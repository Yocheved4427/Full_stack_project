<p-dialog [(visible)]="visible" (onHide)="close()" [modal]="true" [header]="''" [style]="{width: '1400px', maxWidth: '98vw'}" [contentStyle]="{padding: '1.5rem', overflow: 'visible'}">
  <!-- Cart Icon Button -->
  <button 
    pButton 
    icon="pi pi-shopping-cart" 
    class="p-button-rounded p-button-text cart-icon-btn"
    (click)="goToCart()"
    pTooltip="View Cart"
    tooltipPosition="bottom">
  </button>
  
  <div class="quick-view-content" *ngIf="product">
    
    <div class="gallery" *ngIf="images.length > 0">
      <!-- Product Name -->
      <h2 class="product-title">{{product.productName}}</h2>
      
      <!-- Main image display -->
      <div class="main-image-container">
        <button class="nav-button nav-left" (click)="previousImage()" *ngIf="images.length > 1">
          ‹
        </button>
        
        <img [src]="images[activeIndex].itemImageSrc" 
             [alt]="images[activeIndex].alt" 
             class="main-image" />
        
        <button class="nav-button nav-right" (click)="nextImage()" *ngIf="images.length > 1">
          ›
        </button>
      </div>
      
      <!-- Thumbnails -->
      <div class="thumbnails-container" *ngIf="images.length > 1">
        <div class="thumbnail" 
             *ngFor="let img of images; let i = index"
             [class.active]="i === activeIndex"
             (click)="activeIndex = i">
          <img [src]="img.thumbnailImageSrc" [alt]="img.alt" />
        </div>
      </div>
      
      <!-- Indicators -->
      <div class="indicators" *ngIf="images.length > 1">
        <span *ngFor="let img of images; let i = index" 
              [class.active]="i === activeIndex"
              (click)="activeIndex = i">
        </span>
      </div>
    </div>

    <div class="details">
      <div class="description-card">
        <div class="description-header">
          <i class="pi pi-map-marker"></i>
          <span>About This Destination</span>
        </div>
        <div class="description-content">
          <p>{{product.description}}</p>
        </div>
      </div>
      
      <div class="field-group">
        <div class="field">
          <label>Start Date:</label>
          <p-datepicker [(ngModel)]="startDate" [minDate]="minDate" [disabledDates]="disabledDates" (ngModelChange)="onDateChange()" placeholder="Select start date" [style]="{width: '100%'}" appendTo="body"></p-datepicker>
        </div>

        <div class="field">
          <label>End Date:</label>
          <p-datepicker [(ngModel)]="endDate" [minDate]="startDate || minDate" [disabledDates]="disabledDates" (ngModelChange)="onDateChange()" placeholder="Select end date" [style]="{width: '100%'}" appendTo="body"></p-datepicker>
        </div>
      </div>

      <div *ngIf="dateValidationError" class="date-validation-error">
        <i class="pi pi-exclamation-triangle"></i>
        <span>{{dateValidationError}}</span>
      </div>

      <div class="field participants-field">
        <label>Number of Participants:</label>
        <p-inputNumber [(ngModel)]="participants" [min]="1" [max]="20" [showButtons]="true" buttonLayout="horizontal" [step]="1" 
                       showButtonBar="true"
                       [inputStyle]="{width: '50px', textAlign: 'center'}" 
                       [style]="{width: '140px'}">
        </p-inputNumber>
      </div>

      <div *ngIf="peakPeriodMessage" class="peak-period-message">
        <i class="pi pi-info-circle"></i>
        <span>{{peakPeriodMessage}}</span>
      </div>

      <div class="summary-card" *ngIf="totalNights > 0">
        <div class="summary-line"><span>Nights:</span> <strong>{{totalNights}}</strong></div>
        <div class="summary-line"><span>Participants:</span> <strong>{{participants}}</strong></div>
        <div class="total-line"><span>Total Price:</span> <strong>{{totalPrice | currency}}</strong></div>
      </div>

      <button pButton label="Add to Cart" icon="pi pi-shopping-cart" class="add-to-cart-btn" 
              [disabled]="!isFormValid()" (click)="addToCart()"></button>
      
      <div *ngIf="successMessage" class="success-message">{{ successMessage }}</div>

    </div>
  </div>
</p-dialog>